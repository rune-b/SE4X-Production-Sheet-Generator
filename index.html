<!DOCTYPE html>
<html lang="en">
<head>
	<title>Space Empires Production Sheet Generator</title>
	<meta charset="utf-8"/>


	<style type="text/css">
		body {
			font-family: sans-serif;
			font-size: 10pt;
		}

		h1{
			font-style: italic;
			margin: 0.5em 0 0 0;
			padding: 0;
			text-align: center;
			font-size: 150%;
		}

		h2{
			font-style: italic;
			margin: 0.5em 0 0 0;
			padding: 0;
			font-size: 110%;
		}

		li {

		}

		label{
			cursor: pointer;
		}

		table {
			border-collapse: collapse;
		}

		table#productionSheet{
			width: 100%;
		}

		table.technologyProgression{
			width: 33%;
			float: left;
			/*margin-right: 1em;*/
		}
		table.technologyProgression td{			
			height: 1em;
		}

		tbody{
			border-left: solid thick black;
			border-right: solid thick black;
			border-bottom: solid thick black;
		}

		th, td {
			border: solid thin black;
			font-style: italic;
			padding: 0 0.5em;
			font-weight: bold;
		}

		th{
			text-align: right;
		}	

		td sub,
		th sub {
			font-weight: normal;
			font-size: 66%;
		}

		th.group{
			width: 1em;
			max-width: 1em;
			padding: 0 0.1em;
			transform: translate(0, 1.5em) rotate(270deg);
		}

		th.description{
			width: 11em;
		}

		thead{
			border: solid thick black;
			border-bottom-width: medium;
			font-size: 110%;
		}

		th:nth-of-type(1),
		table.technologyProgression td,
		table.technologyProgression th
		{
			border-right-width: medium;
		}

		table.technologyProgression th,
		table.technologyProgression td:nth-of-type(2){
			text-align: center;
		}

		th.phase { 
			text-align: center;
			padding: 0;
			margin: 0;
		}

		tbody.divider{
			border-right: none;
			border-left: none;
		}

		tbody.divider tr td{
			height: 0.4em;
			border: none;
		}
		tr.sum {
			background-color: #eee;		
		}

		tr.header th{
			text-align: left;
			font-size: 110%;
		}

		tr.carry-over th{
			text-align: left;
		}

		tbody.research{
			margin-top: 1em;
		}

		.tech-cost{
			margin-right: 0.5em;
		}

		.miners{
			font-weight: normal;
			margin-left: 1em;
			font-size: 66%;
		}

		@media print {
			@page{
				margin: 2em;
				size: auto landscape;
			}
			#setup {
				display:none;
			}

			body{
				margin: 0;
				padding: 0;
			}

			h1:nth-of-type(1){
				margin-top:0;
				padding-top: 0;
			}

			#productionSheetAndTech{
				width: 100%;
				height: 100%;
				border: solid thin red;
  				page-break-after:always; 
			}

			table#productionSheet{
				height: 100%;
			}
		}

	</style>
	<script type="text/javascript">

		var firstPhaseColumn = 1;

		function init()
		{
			setPhaseColumns(20);
			var phaseColumnsSlider = document.getElementById("phaseColumns");
			phaseColumnsSlider.value = 20;

			var setup = document.getElementById("setup");
			var inputs = setup.getElementsByTagName("input");

			loadSettings(inputs);

			// Event handlers
			for (var i = 0; i < inputs.length; i++)
			{
				var input = inputs[i];
				if (input.id)
				{
					input.addEventListener("click", inputClicked); 
				}
			}

			
			phaseColumnsSlider.addEventListener("input", function() 
			{ 
				setPhaseColumns(parseInt(phaseColumnsSlider.value)); 
			});

		}

		function loadSettings(inputs) 
		{
			for (var i = 0; i < inputs.length; i++)
			{
				inputClicked.call(inputs[i]);
			}
		}

		function saveSettings(){
			//TODO
		}

		function inputClicked()
		{
			if (this.type == "checkbox")
			{
				toggleClass("enable_" + this.id, this.checked);
				toggleClass("disable_" + this.id, !this.checked);
			}
		}

		function setPhaseColumns(columnCount)
		{
			document.getElementById("phaseColumnCount").innerHTML = columnCount;
			var sheet = document.getElementById("productionSheet");
			var currentPhaseCount = sheet.rows[0].cells.length - firstPhaseColumn;

			if (columnCount != currentPhaseCount)
			{
				for (var i = 0; i < sheet.rows.length; i++)
				{
					var row = sheet.rows[i];

					if (columnCount > currentPhaseCount){
						for (var c = currentPhaseCount + 1; c <= columnCount; c++)
						{
							if (i == 0) {
								var th = document.createElement("th");
								th.className = "phase";
								th.innerHTML = c;
								row.appendChild(th);
							}
							else{
								row.insertCell(-1);
							}
						}
					}

					if (columnCount < currentPhaseCount)
					{
						for (var c = currentPhaseCount; c > columnCount; c--)
						{
							row.deleteCell(row.cells.length - 1);
						}
					}				
				}
			}
		}

		function toggleClass(className, visible)
		{
			var ruleSelector = "." + className;

			if (!visible)
			{
				var rule = getStyleRule(ruleSelector);
				if (rule === null) 
				{
					document.styleSheets[0].insertRule(ruleSelector + " { display: none; }", 0);
				}
			}
			else
			{
				deleteStyleRule(ruleSelector);
			}
		}

		function deleteStyleRule(selector)
		{
			var rules = document.styleSheets[0].cssRules;
			for (var i = 0; i < rules.length; i++)
			{
				if (rules[i].selectorText == selector)
				{
					document.styleSheets[0].deleteRule(i);
					return true;
				}
			}
			return false;
		}

		function getStyleRule(selector)
		{
			var rules = document.styleSheets[0].cssRules;
			for (var i = 0; i < rules.length; i++)
			{
				if (rules[i].selectorText == selector)
					return rules[i];
			}
			return null;
		}
	</script>
</head>
<body onload="init()">
	<div id="setup">

		<h1>Select advanced and optional rules</h1>

		<h2>Page setup</h2>

		<ul>
			<li>
				<label><input id="orientationPortrait" name="orientation" type="radio" value="portrait">Portrait</label>
				<label><input id="orientationLandscape" name="orientation" type="radio" value="portrait" checked>Landscape</label>
			</li>
			<li>
				<label>Economic Phase columns: <input type="range" id="phaseColumns" min="10" max="30" /></label>
				<output for="phaseColumns" id="phaseColumnCount"></output>
			</li>
			<li>
				<label><input type="checkbox" id="maintenanceChanges">Show rows for maintenance inrease/decrease</label>
			</li>
		</ul>

		<h2>Base game</h2>

		<ul>
			<li><label><input type="checkbox" id="msPipelines">10. Merchant Ship Pipelines</label></li>
			<li><label><input type="checkbox" id="carriers">11. Carriers, Fighters &amp; Point Defense</label></li>
			<li><label><input type="checkbox" id="cloaking">12. Raiders: Cloaking and Scanners</label></li>
			<li><label><input type="checkbox" id="mines">13. Mines and Mine Sweepers</label></li>
		</ul>

		<h2>Close Encounters</h2>

		<ul>
			<li><label><input type="checkbox" id="reducedTechCosts" disabled>2. Reduced technology costs</label></li>
			<li><label><input type="checkbox" id="experience">3. Ship Experience and Military Academies</label></li>
			<li><label><input type="checkbox" id="boarding">4. Boarding and Capturing Ships</label></li>
			<li><label><input type="checkbox" id="security">5. Security Forces</label></li>
			<li><label><input type="checkbox" id="titans">6. Titans</label></li>
			<li><label><input type="checkbox" disabled>8. Mine Sweeper Technology</label></li>
			<li><label><input type="checkbox" id="movement">9. Movement Technology</label></li>
			<li><label><input type="checkbox" disabled>10. Reaction Movement</label></li>
			<li><label><input type="checkbox" id="fastBC">11. Fast Battlecruisers</label></li>
			<li><label><input type="checkbox" id="groundCombat">14. Transports and Ground Combat</label></li>
			<li><label><input type="checkbox" disabled>16. Flagships</label></li>
			<li><label><input type="checkbox" id="researchCenters">17. Research and Industrial Centers</label></li>
			<li><label><input type="checkbox" id="terraformingNebulae">18. Terraforming Nebulae</label></li>
			<li><label><input type="checkbox" disabled>19. Unique Ships</label></li>
			<li><label><input type="checkbox" disabled>20. Slow Scientists</label></li>
			<li><label><input type="checkbox" disabled>20. Smart Scientists</label></li>
			<li><label><input type="checkbox" disabled>20. Bloody Combat</label></li>
		</ul>
	</div>

	<div id="productionSheetAndTech">
		<h1>Space Empires Production Sheet</h1>
		<table id="productionSheet">
			<thead>
				<tr>
					<!--<th class="group" rowspan="17">Production</th>-->
					<th class="description">Economic Phase</th>
					<th class="phase">1</th>
				</tr>
			</thead>
			<tbody class="production">
				<tr class="carry-over">
					<th>Carry over from last turn</th>
					<td></td>
				</tr>
				<tr>
					<th>+ Colony CPs</th>
					<td></td>
				</tr>
				<tr>
					<th>+ Mineral CPs</th>
					<td></td>
				</tr>
				<tr class="enable_msPipelines">
					<th>+ MS Pipeline CPs</th>
					<td></td>
				</tr>
				<tr class="enable_researchCenters">
					<th>+ Industrial Center CPs</th>
					<td></td>
				</tr>
				<tr class="sum header">
					<th>Total CP</th>
					<td></td>
				</tr>
				<tr>
					<th>- Maintenance</th>
					<td></td>
				</tr>
				<tr>
					<th>- Turn order bid</th>
					<td></td>
				</tr>
				<tr class="enable_researchCenters">
					<th>&le; 15 CP converted to RP</th>
					<td></td>
				</tr>
				<tr class="header">
					<th>Subtotal</th>
					<td></td>
				</tr>
				<tr class="disable_researchCenters">
					<th>- Technology spending</th>
					<td></td>
				</tr>
				<tr class="disable_researchCenters">
					<th>- Ship spending</th>
					<td></td>
				</tr>
				<tr class="enable_researchCenters">
					<th>- Purchases</th>
					<td></td>
				</tr>
				<tr class="sum header">
					<th>Remaining CP</th>
					<td></td>
				</tr>
				<tr>
					<th>CP spent on upgrades</th>
					<td></td>
				</tr>
				<tr class="enable_maintenanceChanges">
					<th>Maint. Increase (buys)</th>
					<td></td>
				</tr>
				<tr class="enable_maintenanceChanges">
					<th>Maint. Decrease (losses)</th>
					<td></td>
				</tr>
			</tbody>

			<tbody class="divider enable_researchCenters">
				<tr>
					<td></td>
					<td></td>
				</tr>
			</tbody>

			<tbody class="research enable_researchCenters">
				
				<tr class="carry-over">
					<!--<th class="group" rowspan="6">Research</th>-->
					<th>Carry over from last turn</th>
					<td></td>
				</tr>
				<tr>
					<th>+ Research Center RPs</th>
					<td></td>
				</tr>
				<tr>
					<th>&le; 15 CP converted to RP</th>
					<td></td>
				</tr>
				<tr class="sum header">
					<th>Total RP</th>
					<td></td>
				</tr>
				<tr>
					<th>- Technology spending</th>
					<td></td>
				</tr>
				<tr class="sum header">
					<th>Remaining RP</th>
					<td></td>
				</tr>
			</tbody>
		</table>

		<h1>Technology Progression &mdash; Circle numbers as technology is purchased</h1>
		<table class="technologyProgression">
			<thead>
				<tr>
					<th>Tech</th>
					<th>Start</th>
					<th>Level<sub>Cost</sub></th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>Ship Size</td>
					<td>1</td>
					<td>
						<span class="tech-cost">2<sub>10</sub></span>
						<span class="tech-cost">3<sub>15</sub></span>
						<span class="tech-cost">4<sub>20</sub></span>
						<span class="tech-cost">5<sub>20</sub></span>
						<span class="tech-cost">6<sub>25</sub></span>
						<span class="tech-cost enable_titans">7<sub>30</sub></span>
					</td>
				</tr>
				<tr>
					<td>Attack</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>10</sub></span>
						<span class="tech-cost">2<sub>20</sub></span>
						<span class="tech-cost">3<sub>30</sub></span>
					</td>
				</tr>
				<tr>
					<td>Defense</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>10</sub></span>
						<span class="tech-cost">2<sub>20</sub></span>
						<span class="tech-cost">3<sub>30</sub></span>
					</td>
				</tr>
				<tr>
					<td>Tactics</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>15</sub></span>
						<span class="tech-cost">2<sub>15</sub></span>
						<span class="tech-cost">3<sub>20</sub></span>
					</td>
				</tr>
				<tr>
					<td>Move</td>
					<td>1</td>
					<td>
						<span class="tech-cost">2<sub>20</sub></span>
						<span class="tech-cost">3<sub>25</sub></span>
						<span class="tech-cost">4<sub>25</sub></span>
						<span class="tech-cost">5<sub>25</sub></span>
						<span class="tech-cost">6<sub>20</sub></span>
						<span class="tech-cost enable_movement">7<sub>20</sub></span>
					</td>
				</tr>
				<tr>
					<td>Ship Yard</td>
					<td>1</td>
					<td>
						<span class="tech-cost">2<sub>20</sub></span>
						<span class="tech-cost">3<sub>30</sub></span>
					</td>
				</tr>
				<tr class="enable_groundCombat">
					<td>Ground</td>
					<td>1</td>
					<td>
						<span class="tech-cost">2<sub>10</sub></span>
						<span class="tech-cost">3<sub>15</sub></span>
					</td>
				</tr>
			</table>
			<table class="technologyProgression">
			<thead>
				<tr>
					<th>Tech</th>
					<th>Start</th>
					<th>Level<sub>Cost</sub></th>
				</tr>
			</thead>
			<tbody>
				<tr class="enable_carriers">
					<td>Fighters</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>25</sub></span>
						<span class="tech-cost">2<sub>30</sub></span>
						<span class="tech-cost">3<sub>40</sub></span>
					</td>
				</tr>
				<tr class="enable_carriers">
					<td>Point Def.</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>20</sub></span>
						<span class="tech-cost">2<sub>25</sub></span>
						<span class="tech-cost">3<sub>30</sub></span>
					</td>
				</tr>
				<tr>
					<td>Terraforming</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>20</sub></span>
						<span class="tech-cost enable_terraformingNebulae">2<sub>35</sub></span>
						<span class="miners enable_terraformingNebulae">1 2 3 4</span>
					</td>
				</tr>
				<tr class="enable_cloaking">
					<td>Cloaking</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>30</sub></span>
						<span class="tech-cost">2<sub>40</sub></span>
					</td>
				</tr>
				<tr class="enable_cloaking">
					<td>Scanners</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>20</sub></span>
						<span class="tech-cost">2<sub>30</sub></span>
					</td>
				</tr>
				<tr class="enable_mines">
					<td>Mines</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>30</sub></span>
					</td>
				</tr>
				<tr class="enable_mines">
					<td>Mine Sweeper</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>10</sub></span>
						<span class="tech-cost">2<sub>15</sub></span>
						<span class="tech-cost">3<sub>20</sub></span>
					</td>
				</tr>
			</table>
			<table class="technologyProgression">
			<thead>
				<tr>
					<th>Tech</th>
					<th>Start</th>
					<th>Level<sub>Cost</sub></th>
				</tr>
			</thead>
			<tbody>
				<tr class="enable_experience">
					<td>Military Acad.</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>10</sub></span>
						<span class="tech-cost">2<sub>20</sub></span>
					</td>
				</tr>
				<tr class="enable_boarding">
					<td>Boarding</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>20</sub></span>
						<span class="tech-cost">2<sub>25</sub></span>
					</td>
				</tr>
				<tr class="enable_security">
					<td>Security</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>15</sub></span>
						<span class="tech-cost">2<sub>15</sub></span>
					</td>
				</tr>
				<tr>
					<td>Exploration</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>15</sub></span>
						<span class="tech-cost">2<sub>15</sub></span>
					</td>
				</tr>
				<tr class="enable_fastBC">
					<td>Fast BC</td>
					<td>0</td>
					<td>
						<span class="tech-cost">1<sub>10</sub></span>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
	<div id="shipTechnologySheet">
		test
	</div>

</body>

</html>